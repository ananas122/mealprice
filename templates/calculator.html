<!DOCTYPE html>
<html>
<head>
  <title>Calculator</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Inclure les liens vers les fichiers CSS de la barre latérale et des ingrédients -->
  <link rel="stylesheet" href="static/css/dashboard.css">
  
  <link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
  <h2>Calculator</h2>
  
  <div id="sidebar">
    <!-- Contenu de la barre latérale depuis dashboard.css -->
  </div>
  <div id="content-container">

<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
}

.container {
    max-width: 300px;
    margin: 50px auto;
    padding: 20px;
    background-color: #fff;
    border: 1px solid #e0e0e0;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border-radius: 5px;
}

input {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    box-sizing: border-box;
}

button {
    width: 100%;
    padding: 10px;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

button:hover {
    background-color: #0056b3;
}

p {
    margin-top: 20px;
}

#resultat span {
    font-weight: bold;
}
</style>
 <form id="recipe-calculator-desktop">
        <table>
            <thead>
                <tr>
                    <th colspan="3">Recette</th>
                    <th colspan="3">Méthode</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="3">
                        <label for="f_name"><strong>Nom de la recette</strong></label>
                        <input type="text" id="f_name" name="f_name">
                    </td>
                    <td colspan="3" rowspan="2">
                        <label for="method"><strong>Ajoutez votre méthode</strong></label>
                        <textarea id="method" name="method"></textarea>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <label for="f_servings"><strong>Nombre de portions</strong></label>
                        <input type="number" name="f_servings" min="1" value="1">
                    </td>
                </tr>
                <tr>
                    <td colspan="6"><h1>Ingrédients</h1></td>
                </tr>
                <tr>
                    <td colspan="2">Nom de l'ingrédient</td>
                    <td>Qté achetée</td>
                    <td>Coût des marchandises</td>
                    <td>Qté utilisée dans la recette</td>
                    <td>Coût total</td>
                </tr>
                <!-- Vous pouvez dupliquer cette ligne pour chaque ingrédient -->
                <tr id="row_1">
                    <td colspan="2">
                        <input type="text" name="f_ingredients_1">
                    </td>
                    <td>
                        <input type="number" step="any" name="f_quantity_1" min="0">
                        <select name="f_unit_1">
                            <option value="g">g</option>
                            <option value="mg">mg</option>
                            <option value="L">L</option>
                            <option value="mL">mL</option>
                            <option value="unité">unité</option>
                        </select>
                    </td>
                    <td>
                        <input type="number" step="any" name="f_cost_1" placeholder="€" min="0">
                    </td>
                    <td>
                        <input type="number" step="any" name="f_used_1" placeholder="g / mL / unité" min="0">
                    </td>
                    <td>
                        <input type="text" name="f_total_1" placeholder="€0.00" readonly>
                    </td>
                </tr>
            </tbody>
            <tfoot>
<tr>
        <td colspan="5">Coût total de la recette :</td>
        <td id="grandTotal" placeholder="€0.00">€0.00</td>
    </tr>
    </tfoot>
        </table>
        <button type="button" data-add>+ Ajouter un ingrédient supplémentaire</button>
        <button type="submit">Envoyer</button>
    </form>

    <script>
  
    let rowNumber = 1; // on commence avec une ligne

    // Ajout d'ingrédient supplémentaire
    document.querySelector("button[type='button']").addEventListener('click', function() {
        rowNumber++;
        let newRow = `
        <tr id="row_${rowNumber}" class="ingred-row">
            <td colspan="2">
                <input type="text" name="f_ingredients_${rowNumber}">
            </td>
            <td>
                <input type="number" step="any" name="f_quantity_${rowNumber}" placeholder="g / mL / unité" min="0">
            </td>
            <td>
                <input type="number" step="any" name="f_cost_${rowNumber}" placeholder="€" min="0">
            </td>
            <td>
                <input type="number" step="any" name="f_used_${rowNumber}" placeholder="g / mL / unité" min="0">
            </td>
            <td>
                <input type="text" name="f_total_${rowNumber}" placeholder="€0.00" readonly>
            </td>
        </tr>`;

        let tbody = document.querySelector("tbody");
        tbody.insertAdjacentHTML('beforeend', newRow);
    });

    // Fonction pour calculer le coût total
    function calculateTotal() {
        let grandTotal = 0;
        for (let i = 1; i <= rowNumber; i++) {
            let quantity = document.querySelector(`[name="f_quantity_${i}"]`).value;
            let cost = document.querySelector(`[name="f_cost_${i}"]`).value;
            let used = document.querySelector(`[name="f_used_${i}"]`).value;
            if (quantity && cost && used) {
                let total = (cost / quantity) * used;
                document.querySelector(`[name="f_total_${i}"]`).value = `€${total.toFixed(2)}`;
                grandTotal += total;
            }
        }
        return grandTotal;
    }

    // Soumission du formulaire pour le calcul
    document.getElementById("recipe-calculator-desktop").addEventListener('submit', function(event) {
        event.preventDefault();
        let grandTotal = calculateTotal();
        alert(`Le coût total est: €${grandTotal.toFixed(2)}`);
    });
    function calculateTotal() {
    let grandTotal = 0;
    for (let i = 1; i <= rowNumber; i++) {
        let quantity = document.querySelector(`[name="f_quantity_${i}"]`).value;
        let cost = document.querySelector(`[name="f_cost_${i}"]`).value;
        let used = document.querySelector(`[name="f_used_${i}"]`).value;
        if (quantity && cost && used) {
            let total = (cost / quantity) * used;
            document.querySelector(`[name="f_total_${i}"]`).value = `€${total.toFixed(2)}`;
            grandTotal += total;
        }
    }

    // Mise à jour du coût total dans le pied de table
    document.getElementById("grandTotal").textContent = `€${grandTotal.toFixed(2)}`;

    return grandTotal;
}

</script>

</body>

</html>

